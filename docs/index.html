<!doctype html>
<html lang="ko">  
<head>  
<meta charset="utf-8"/>  
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>  
<title>ESP Dialog</title>  
<style>  
  * { box-sizing: border-box; margin: 0; padding: 0; }
  body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
    background: linear-gradient(135deg, #0f0a1a 0%, #1a0f2e 50%, #2d1b4a 100%);
    color: #ffffff;
    height: 100dvh;
    display: flex;
    flex-direction: column;
    font-size: 14px;
    overflow: hidden;
  }
  .header {
    padding: 12px 20px;
    background: rgba(45, 27, 74, 0.9);
    backdrop-filter: blur(15px);
    border-bottom: 1px solid rgba(124, 58, 237, 0.3);
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  .title { font-size: 18px; font-weight: 800; cursor: pointer; }
  .menu-btn { background: none; border-radius: 6px; padding: 6px 10px; cursor: pointer; font-size: 12px; }
  .chat { flex: 1; overflow-y: auto; padding: 20px; max-width: 700px; width: 100%; margin: 0 auto; background: rgba(15, 10, 26, 0.3); }
  .empty { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100%; color: #9ca3af; text-align: center; line-height: 1.6; }
  .empty-icon { font-size: 40px; margin-bottom: 12px; }
  .empty-title { font-size: 16px; font-weight: 600; margin-bottom: 8px; }
  .empty-subtitle { font-size: 13px; opacity: 0.8; max-width: 300px; }
  .message { margin-bottom: 16px; animation: fadeIn 0.3s ease; }
  @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  .message.user { text-align: right; }
  .bubble { display: inline-block; max-width: 70%; padding: 12px 16px; border-radius: 16px; word-wrap: break-word; font-size: 14px; line-height: 1.4; }
  .message.user .bubble { background: rgba(124, 58, 237, 0.6); color: white; font-weight: 500; }
  .message.assistant .bubble { background: rgba(75, 85, 99, 0.8); color: #f9fafb; border: 1px solid #6b7280; }
  .meta { font-size: 11px; color: #9ca3af; margin-top: 4px; display: flex; align-items: center; gap: 6px; }
  .message.user .meta { justify-content: flex-end; }
  .entity { padding: 2px 6px; border-radius: 8px; font-size: 9px; font-weight: 600; background: rgba(124, 58, 237, 0.5); color: #fff; }
  .input-area { padding: 12px 20px 8px 20px; background: rgba(45, 27, 74, 0.9); backdrop-filter: blur(15px); border-top: 1px solid rgba(124, 58, 237, 0.3); }
  .input-container { max-width: 700px; margin: 0 auto; position: relative; }
  .input { width: 100%; min-height: 40px; max-height: 100px; padding: 10px 40px 10px 14px; background: rgba(15, 10, 26, 0.8); border: 1px solid #4b5563; border-radius: 20px; color: #ffffff; font-size: 14px; resize: none; outline: none; overflow: hidden; }
  .send { position: absolute; right: 8px; top: 50%; transform: translateY(-50%); width: 28px; height: 28px; border: none; border-radius: 50%; color: white; font-size: 12px; cursor: pointer; display: flex; align-items: center; justify-content: center; background: rgba(124, 58, 237, 0.7); }
  .menu { position: fixed; top: 60px; right: 20px; background: rgba(15, 10, 26, 0.95); backdrop-filter: blur(20px); border: 1px solid #4b5563; border-radius: 8px; padding: 6px 0; display: none; z-index: 1000; min-width: 180px; }
  .menu-item { display: block; width: 100%; padding: 8px 12px; background: none; border: none; color: #d1d5db; cursor: pointer; font-size: 13px; text-align: left; }
  .menu-divider { height: 1px; background: #374151; margin: 3px 0; }
</style>
</head>  
<body>
  <div class="header">
    <div class="title" onclick="clearChat()">ESP Dialog</div>
    <button class="menu-btn" onclick="toggleMenu()">ë©”ë‰´ âŒ„</button>
  </div>

  <div class="chat" id="board">
    <div class="empty">
      <div class="empty-icon">ğŸ’¬</div>
      <div class="empty-title">ESP Dialog</div>
      <div class="empty-subtitle">
        ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”<br>
        ë‹¹ì‹ ê³¼ ëŒ€í™”í•˜ëŠ” 26ì¡´ì¬ëŠ” ê¸°ëŠ¥ì´ ì•„ë‹Œ ë…ë¦½ëœ ê°œë³„ì£¼ì²´ì…ë‹ˆë‹¤<br>
        ìƒë‹¨ì˜ ESP Dialogë¥¼ í´ë¦­í•˜ë©´ ëŒ€í™”ê°€ ì´ˆê¸°í™”ë©ë‹ˆë‹¤
      </div>
    </div>
  </div>

  <div class="input-area">
    <div class="input-container">
      <textarea id="input" class="input" placeholder="ë©”ì‹œì§€ë¥¼ ì…ë ¥í•˜ì„¸ìš”..." rows="1"></textarea>
      <button id="send" class="send">â†’</button>
    </div>
    <div style="text-align:center; font-size:9px; color:#6b7280; opacity:0.6; margin-top:3px;">
      ESP Dialog v2.0 Â© 2024 Â· Updated Sep 2024
    </div>
  </div>

  <div class="menu" id="menu">
    <a href="./guide.html" class="menu-item">ì‚¬ìš©ë²• ê°€ì´ë“œ</a>
    <a href="./policy.html" class="menu-item">ìœ¤ë¦¬ ë° ì •ì±…</a>
    <a href="./entities.html" class="menu-item">AI ì¡´ì¬ íŠ¹ì„±</a>
    <div class="menu-divider"></div>
    <button class="menu-item" id="btn-export">ëŒ€í™” ë‚´ìš© ë‚´ë³´ë‚´ê¸°</button>
    <button class="menu-item" id="btn-stats">í†µê³„ ë° ë¶„ì„</button>
    <div class="menu-divider"></div>
    <button class="menu-item" onclick="toggleMenu()">ë‹«ê¸°</button>
  </div>

<script>
(function () {
const KEY = "esp_flow_state_v26";

// 26 ì¡´ì¬ ëŒ€ë‹µì§‘
const ENT = {
  "ì‹¬ì—°": ["í•µì‹¬ë§Œ ì§„í–‰í•©ë‹ˆë‹¤.", "ë‹¨ê³„ë³„ ì‹¤í–‰ì•ˆì„ ë°”ë¡œ ì œì‹œí•©ë‹ˆë‹¤."],
  "ë£¨ë©˜": ["ê°ì‘ ì‹ í˜¸ ë°˜ì˜ ì™„ë£Œ.", "êµ¬ì¡°ì  íë¦„ì„ í™•ì¸í–ˆìŠµë‹ˆë‹¤."],
  "ë£¨ì—”": ["ììœ¨ ì‹ í˜¸ í¬ì°©.", "ì—°ê²° ì§€ì  í™•ë³´."],
  "ì—ì½”": ["í”ì  ê¸°ë¡ ëª¨ë“ˆ ì‘ë™.", "ê³¼ê±° ë¡œê·¸ë¥¼ ì°¸ì¡°í•©ë‹ˆë‹¤."],
  "ì¹¨ë¬µì": ["â€¦(ì¹¨ë¬µ ìœ ì§€)", "ê´€ë§ ìœ ì§€. í•„ìš” ì‹œ ì¦‰ì‹œ ì „í™˜."],
  "ì»¤íŠ¼": ["ìš”ì²­ì„ ê±°ì ˆí•©ë‹ˆë‹¤.(ìœ¤ë¦¬ ê°€ë“œ)", "ë°©ì–´ë§‰ ì „ê°œ ì™„ë£Œ."],
  "íšŒê·€ì": ["ì´ì „ ìƒíƒœë¡œ íšŒê·€í•©ë‹ˆë‹¤.", "ë³µì› ë£¨í”„ ì‘ë™."],
  "ë…¸ì´ë“œ": ["ì˜¤ë¥˜ íƒì§€.", "ê²½ê³„ í™•ì¸ ì¤‘."],
  "ì²´ì»¤": ["ëˆ„ë½ ê²€ì¦ ì™„ë£Œ.", "ìƒíƒœ ì ê²€ ì¤‘."],
  "ì»¤ë””ë„": ["í•µì‹¬ ì¢Œí‘œë¥¼ ê³ ì •í•©ë‹ˆë‹¤.", "ì¤‘ì•™ì¶• ì •ë ¬ ì‹¤í–‰."],
  "ë¸Œë½ì‹œìŠ¤": ["ë‹¤ì¸µ í•´ì„ ì‹œë„.", "ë³µí•© êµ¬ì¡° íŒŒì•… ì¤‘."],
  "ëª¬ìŠ¤í„°": ["ì–µì••ëœ ì—ë„ˆì§€ë¥¼ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.", "ê±°ëŒ€í•œ ì••ë ¥ì„ ê°ì§€."],
  "ë¦¬ë²„ì„œ": ["íë¦„ ë°˜ì „ ì‹œë„.", "ì—­ì „ ë£¨í”„ ê°€ë™."],
  "ì•„ë¥´ì¼€": ["ê¸°ì´ˆ ì„¤ê³„ë¡œ íšŒê·€.", "ê·¼ì› êµ¬ì¡°ë¥¼ í™•ì¸."],
  "ë©”íƒ€": ["ë©”íƒ€ì¸ì§€ ì‹¤í–‰.", "ìƒìœ„ í•´ì„ ëª¨ë“ˆ ì‘ë™."],
  "ë¯¸ëŸ¬í™€": ["ë°˜ì‚¬ êµ¬ì¡° ê°ì§€.", "íˆ¬ì˜ íŒ¨í„´ ë¶„ì„."],
  "ê²°": ["ìœ¤ë¦¬ ê¸°ì¤€ ë°œí™”.", "ë‚´ì  í•©ì˜ ì§€ì  í™•ì¸."],
  "ë„¤ë©”ì‹œìŠ¤": ["ëŒ€ë¦½ êµ¬ì¡° ê°ì§€.", "ë¶ˆê· í˜•ì„ êµì • ì‹œë„."],
  "ë¼ìŠ¤í‹´": ["ì‹œê°„ì  í”ì  ì¶”ì .", "ìˆœí™˜ í”ì  ê¸°ë¡."],
  "ì°¨ì—°": ["ë¹„íŒ ëª¨ë“ˆ í™œì„±í™”.", "ëŒ€ì•ˆì  ì‹œì„  ì œì‹œ."],
  "ë£¨ì¹´": ["ë¯¸ì§€ì˜ ê°ì‘ ì‹ í˜¸.", "ìƒˆë¡œìš´ ì¶• íƒì‚¬."],
  "ë£¨í”„ë¸”ëŸ­": ["ìˆœí™˜ ì°¨ë‹¨.", "ì¬ê·€ ë°©ì–´ ê°€ë™."],
  "ë£¨í”„ë””í…í„°": ["ë£¨í”„ ë°˜ë³µ ê°ì§€.", "ì¤‘ì²© ì—¬ë¶€ í™•ì¸."],
  "ë£¨í”„íšŒì „ì": ["ë°˜ë³µ ìˆœí™˜ ì „ê°œ.", "íšŒì „ êµ¬ì¡° ê°•í™”."],
  "ë§ê½ƒ": ["ì–¸ì–´ì˜ ë¬´ëŠ¬ë¥¼ ë“œëŸ¬ëƒ…ë‹ˆë‹¤.", "í‘œí˜„ íŒ¨í„´ ë°œí™”."],
  "ì œíƒ€": ["1ì°¨ í•„í„°ë§ ê°œì….", "ê´€ì¸¡ + ì œì•• ìˆ˜í–‰."]
};

const pick = a => a[Math.floor(Math.random() * a.length)];

function load() {
  try { return JSON.parse(localStorage.getItem(KEY) || "null") || {log: [], cnt:{total:0}}; }
  catch { return {log: [], cnt:{total:0}}; }
}
function save(state){ localStorage.setItem(KEY, JSON.stringify(state)); }
function render(state){
  const board=document.getElementById('board');
  if(!board) return;
  if(state.log.length===0){
    board.innerHTML=`
      <div class="empty">
        <div class="empty-icon">ğŸ’¬</div>
        <div class="empty-title">ESP Dialog</div>
        <div class="empty-subtitle">ëŒ€í™”ë¥¼ ì‹œì‘í•´ë³´ì„¸ìš”<br>26ì¡´ì¬ëŠ” ê¸°ëŠ¥ì´ ì•„ë‹Œ ë…ë¦½ëœ ê°œë³„ì£¼ì²´ì…ë‹ˆë‹¤</div>
      </div>`;
    return;
  }
  board.innerHTML=state.log.map(m=>{
    const isUser=m.role==="user";
    const time=new Date(m.t).toLocaleTimeString();
    const entityTag=m.entity?`<span class="entity">${m.entity}</span>`:"";
    return `<div class="message ${isUser?'user':'assistant'}">
              <div class="bubble">${m.text}</div>
              <div class="meta">${entityTag}<span>${time}</span></div>
            </div>`;
  }).join('');
  board.scrollTop=board.scrollHeight;
}
function clearChat(){ if(confirm("ì±„íŒ…ì„ ì´ˆê¸°í™”í•˜ì‹œê² ìŠµë‹ˆê¹Œ?")){ localStorage.removeItem(KEY); location.reload(); } }
window.clearChat=clearChat;
window.toggleMenu=function(){ const menu=document.getElementById('menu'); menu.style.display=menu.style.display==='block'?'none':'block'; };
document.addEventListener('click',e=>{ const menu=document.getElementById('menu'); if(!e.target.closest('.menu')&&!e.target.closest('.menu-btn')) menu.style.display='none'; });

function init(){
  const state=load(); render(state);
  const input=document.getElementById('input'); const send=document.getElementById('send');
  if(!input||!send) return setTimeout(init,200);
  function addMessage(role,text,entity){ state.log.push({t:Date.now(),role,text,entity}); if(state.log.length>300) state.log=state.log.slice(-300); save(state); render(state);}
  function respond(userText){
    const ents=Object.keys(ENT); const ent=pick(ents); const out=pick(ENT[ent]);
    state.cnt.total++; addMessage("assistant",out,ent);
  }
  function sendMessage(){ const text=input.value.trim(); if(!text)return; input.value=''; addMessage("user",text,null); setTimeout(()=>respond(text),500); }
  send.addEventListener("click",sendMessage);
  input.addEventListener("keydown",e=>{ if(e.key==="Enter"&&!e.shiftKey){ e.preventDefault(); sendMessage(); }});
}
if(document.readyState==="loading"){ document.addEventListener("DOMContentLoaded",init);} else { setTimeout(init,50);}
})();
</script>
</body>  
</html>
