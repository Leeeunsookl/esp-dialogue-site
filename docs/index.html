<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <meta name="robots" content="noindex,nofollow"/>
  <title>ESP Flow</title>
  <style>
    :root{
      --bg:#0b0e11; --fg:#e8eef5; --muted:#8a97a6;
      --line:#1a2028; --card:#10151b; --accent:#78f3ff;
      --safe-t: env(safe-area-inset-top); --safe-b: env(safe-area-inset-bottom);
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; color:var(--fg); background:var(--bg);
      font:15px/1.55 system-ui,Segoe UI,Roboto,Apple SD Gothic Neo,AppleGothic,sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }
    .wrap{min-height:100dvh; display:grid; grid-template-rows:auto 1fr auto; gap:10px; padding:10px; padding-top:calc(10px + var(--safe-t)); padding-bottom:calc(10px + var(--safe-b)); max-width:960px; margin:0 auto}
    /* Toolbar */
    .toolbar{
      position:sticky; top:calc(0px + var(--safe-t)); z-index:20;
      display:flex; gap:8px; align-items:center; justify-content:space-between;
      padding:8px; border:1px solid var(--line); border-radius:12px; background:#0d1218cc; backdrop-filter:blur(4px)
    }
    .toolbar .left{display:flex;gap:8px;align-items:center}
    button{
      appearance:none; border:1px solid var(--line); background:#0e1822; color:var(--fg);
      padding:12px 14px; border-radius:12px; min-width:96px; font-weight:700; cursor:pointer
    }
    button.primary{background:var(--accent); color:#001118; border-color:#0f2533}
    button:active{transform:translateY(1px)}
    /* Board */
    .board{
      border:1px solid var(--line); border-radius:12px; background:var(--card);
      padding:10px; display:flex; flex-direction:column; gap:10px;
      max-height:min(60vh,560px); overflow:auto
    }
    .msg{max-width:88%; padding:10px 12px; border-radius:14px; border:1px solid var(--line); background:#0d1218}
    .me{align-self:flex-end; background:#0e1822; border-color:#0f2533}
    .meta{margin-top:4px; font-size:12px; color:var(--muted)}
    /* Composer */
    .composer{display:grid; grid-template-columns:1fr auto; gap:8px; align-items:end}
    textarea{
      width:100%; min-height:44px; max-height:40vh; resize:none; line-height:1.5;
      padding:12px; border-radius:12px; border:1px solid var(--line); background:#0c1117; color:var(--fg)
    }
    .panel{
      border:1px dashed var(--line); border-radius:12px; background:#0d1218; padding:8px 10px; color:var(--muted); font-size:13px
    }
    .hidden{display:none}
    #metrics{font-variant-numeric:tabular-nums}
    /* Small screens */
    @media (max-width:520px){
      button{min-width:auto; padding:12px 12px}
      .board{max-height:min(58vh,520px)}
    }
    @media (prefers-reduced-motion:reduce){*{animation:none!important;transition:none!important}}
  </style>
</head>
<body>
  <div class="wrap">
    <!-- Toolbar -->
    <div class="toolbar" id="flow-toolbar">
      <div class="left">
        <button id="flow-send" class="primary" aria-label="메시지 전송">전송</button>
        <button id="flow-actions" aria-label="액션 로그 토글">Actions</button>
      </div>
      <div class="right">
        <button id="flow-export" aria-label="상태 내보내기">Export</button>
      </div>
    </div>

    <!-- Board -->
    <section class="board" id="flow-log" aria-live="polite" aria-label="대화 로그"></section>

    <!-- Composer -->
    <section class="composer">
      <textarea id="flow-input" placeholder="메시지를 입력… (Enter 전송, Shift+Enter 줄바꿈)"></textarea>
      <button id="flow-send-ghost" class="primary" aria-label="메시지 전송(우측)">전송</button>
    </section>

    <!-- Panels -->
    <section id="metrics" class="panel">Autonomy 0.0% · total 0 · reject 0 · silence 0</section>
    <section id="actions-pane" class="panel hidden"><pre style="margin:0;white-space:pre-wrap;word-break:break-word">Actions: (empty)</pre></section>
  </div>

  <!-- Flow mount hook -->
  <script type="esp/flow">{ "mount": "body" }</script>
  <!-- Engine -->
  <script src="/docs/esp_autopilot.js?v=2025-09-09-ui" defer></script>
</body>
</html>
